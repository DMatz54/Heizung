<!-- For more information visit:https://fipsok.de --><!DOCTYPE HTML><html lang="de"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="style.css"><title>Esp8266 Datei Manager</title><script>function list(){let myList = document.querySelector('main');fetch('json').then(function(response){return response.json()}).then(function(json){for(var i = 0;i < json.length - 1;i++){let dir = `<li><a href ="${json[i].name}">${json[i].name}</a><small>${json[i].size}</small><a href ="${json[i].name}"download="${json[i].name}">Download </a>`;if(json[i].name!= 'spiffs.html'){dir+= `or <a href ="${json[i].name}?delete=/${json[i].name}">Delete </a>`}myList.insertAdjacentHTML('beforeend',dir)}myList.insertAdjacentHTML('beforeend',`<li><b>SPIFFS</b>belegt ${json[i].usedBytes}von ${json[i].totalBytes}`);free = json[i].freeBytes})}function fileSize(){let bytes = event.target.files[0].size,output = `${bytes}Byte`;let a = document.querySelector('span'),b = document.querySelector('[value=Upload]');for(let unit = [' KB',' MB'],i = 0,circa = bytes / 1024;circa>1;circa /= 1024,i++){output = circa.toFixed(2)+unit[i]}if(bytes>free){a.innerHTML = `<li><small>Dateigröße:${output}</small><strong style="color: red;">Ungenügend Speicher frei </strong></li>`;b.setAttribute('disabled','disabled')}else{a.innerHTML = `<li><b>Dateigröße:</b>${output}</li>`;b.removeAttribute('disabled')}}function jn(){return confirm(`Wirklich formatieren? Alle Daten gehen verloren.\nDu musst anschließend spiffs.html wieder laden.`)}document.addEventListener('DOMContentLoaded',list);</script></head><body><h2>ESP8266 Datei Manager</h2><form action="/upload" method="POST" enctype="multipart/form-data"><input type="file" name="upload" onchange="fileSize()"><input type="submit" value="Upload" disabled></form><div><span></span><main></main></div><form action="/format" method="POST"><input type="submit" value="Format SPIFFS" onclick="return jn()"></form></body></html>